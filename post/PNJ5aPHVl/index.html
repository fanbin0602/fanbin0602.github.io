<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MyCat è¯»å†™åˆ†ç¦»é…ç½® | MQ LOG</title>
<meta name="description" content="<span style='color:lightgrey;font-size:12px'>/* MQ is short for æ‡µåœˆå„¿ */</span>" />
<link rel="shortcut icon" href="https://blog.fanbin.dev/favicon.ico?v=1573788389084">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://blog.fanbin.dev/styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-50640413-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-50640413-3');
</script>


  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://blog.fanbin.dev">
  <img class="avatar" src="https://blog.fanbin.dev/images/avatar.png?v=1573788389084" alt="">
  </a>
  <h1 class="site-title">
    MQ LOG
  </h1>
  <p class="site-description">
    <span style='color:lightgrey;font-size:12px'>/* MQ is short for æ‡µåœˆå„¿ */</span>
  </p>
  <div class="menu-container">
    
      
        <a href="https://blog.fanbin.dev" class="menu">
          ğŸ é¦–é¡µ
        </a>
      
    
      
        <a href="https://blog.fanbin.dev/tag/programming/" class="menu">
          ğŸ–¥ï¸ç¼–ç¨‹
        </a>
      
    
      
        <a href="https://blog.fanbin.dev/tag/product/" class="menu">
          ğŸ“±äº§å“
        </a>
      
    
      
        <a href="https://blog.fanbin.dev/tag/cognition/" class="menu">
          ğŸ“šæ–°çŸ¥
        </a>
      
    
      
        <a href="https://blog.fanbin.dev/tag/notes/" class="menu">
          ğŸ–‹ï¸æ‰‹è®°
        </a>
      
    
      
        <a href="https://blog.fanbin.dev/archives" class="menu">
          ğŸ“¦å½’æ¡£
        </a>
      
    
      
        <a href="https://blog.fanbin.dev/tags" class="menu">
          ğŸ·ï¸æ ‡ç­¾
        </a>
      
    
      
        <a href="https://blog.fanbin.dev/post/about/" class="menu">
          ğŸ˜³å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/fanbin0602" target="_blank">
          <i class="fab fa-github"></i>
        </a>
      
    
      
    
      
        <a href="https://weibo.com/imfxx" target="_blank">
          <i class="fab fa-weibo"></i>
        </a>
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              MyCat è¯»å†™åˆ†ç¦»é…ç½®
            </h2>
            <div class="post-info">
              <span>
                2019-09-07
              </span>
              <span>
                7 min read
              </span>
              
                <a href="https://blog.fanbin.dev/tag/programming" class="post-tag">
                  # ç¼–ç¨‹
                </a>
              
            </div>
            
              <img class="post-feature-image" src="http://blog-fanbin-ink.img.fanbin.ink/post/PNJ5aPHVl/0.2.jpeg" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p>è¿™ç¯‡æ˜¯åŸºäº<a href="/post/Qg_Mg199T/">å¦ä¸€ç¯‡</a>å½“ä¸­ MySQL ä¸»ä»å¤åˆ¶çš„ç¤ºä¾‹ï¼Œæ¥ç”¨ MyCat ä½œä¸ºæ•°æ®åº“ä¸­é—´ä»¶ï¼Œå®ç°åªå¯¹å¤–æš´éœ²ä¸€ä¸ªæ•°æ®åº“è¿æ¥å…¥å£çš„ MySQL è¯»å†™åˆ†ç¦»ã€‚</p>
<!-- more -->
<h2 id="0-å‰æ">0. å‰æ</h2>
<ol>
<li>å®Œæˆ MySQL ä¸»ä»å¤åˆ¶çš„éƒ¨ç½²ï¼ˆ<a href="/post/Qg_Mg199T/">ä¼ é€é—¨</a>ï¼‰ã€‚</li>
<li>è¿˜æ˜¯åŸºäº Dockerï¼Œè¿è¡Œä¸€ä¸ª MyCat å®¹å™¨ã€‚</li>
<li>åº”è¯¥å°±è¿™äº›ã€‚</li>
</ol>
<h2 id="1-mycat-å®¹å™¨éƒ¨ç½²">1. MyCat å®¹å™¨éƒ¨ç½²</h2>
<p>é¦–å…ˆï¼Œä¸‹è½½ MyCatã€‚ç”±äºæˆ‘ä»¬è¦ä¸è¾“åœ¨å®¹å™¨é‡Œï¼Œæ‰€ä»¥ä¸‹è½½ Linux çš„ç‰ˆæœ¬ã€‚</p>
<pre><code class="language-bash">$ wget http://dl.mycat.io/1.6.7.1/Mycat-server-1.6.7.1-release-20190627191042-linux.tar.gz
</code></pre>
<p>æ­¤æ—¶ï¼Œå¾—åˆ°ä¸€ä¸ª <code>Mycat-server-1.6.7.1-release-20190627191042-linux.tar.gz</code> æ–‡ä»¶ã€‚ä¸ºäº†æ–¹ä¾¿åé¢ä½¿ç”¨ï¼Œç»™å®ƒæ”¹ä¸ªåå­—ã€‚</p>
<pre><code class="language-bash">$ mv Mycat-server-1.6.7.1-release-20190627191042-linux.tar.gz mycat.tar.gz
</code></pre>
<p>åœ¨å½“å‰ç›®å½•è§£å‹å®ƒï¼Œå¹¶æŠŠå…¶ä¸­çš„ <code>conf</code> ç›®å½•æ‹·è´ä¸€ä»½ï¼Œä¾› Docker å®¹å™¨æŒ‚è½½ï¼Œè¿™æ ·å°±ä¸éœ€è¦è¿›å…¥åˆ°å®¹å™¨é‡Œé¢ä¿®æ”¹ MyCat çš„é…ç½®ã€‚</p>
<pre><code class="language-bash">$ tar -zxvf mycat.tar.gz
$ cp -r mycat/conf/ conf/
</code></pre>
<p>å‡†å¤‡å·¥ä½œå®Œæˆåï¼Œå¼€å§‹æ„å»ºå®¹å™¨é•œåƒï¼Œåˆ›å»ºä¸€ä¸ª Dockerfileï¼Œåœ¨å…¶ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code>FROM openjdk:8
ADD mycat.tar.gz /usr/local/
VOLUME /usr/local/mycat/conf
ENV MYCAT_HOME=/usr/local/mycat
EXPOSE 8066 9066
CMD [&quot;/usr/local/mycat/bin/mycat&quot;,&quot;console&quot;,&quot;&amp;&quot;]
</code></pre>
<p>é€è¡Œè§£é‡Šä¸€ä¸‹ Dockerfile çš„å†…å®¹ï¼š</p>
<ol>
<li>MyCat åŸºäº Javaï¼Œå› æ­¤ä½¿ç”¨ <code>openjdk:8</code> é•œåƒæ„å»ºæˆ‘ä»¬ä½¿ç”¨çš„ MyCat é•œåƒã€‚</li>
<li>å°†ä¸‹è½½å¹¶é‡å‘½åå¥½çš„ <code>mycat.tar.gz</code> æ·»åŠ åˆ°å®¹å™¨çš„ <code>/usr/local/</code> ç›®å½•ã€‚</li>
<li>å°† MyCat çš„é…ç½®æ–‡ä»¶ç›®å½• <code>/usr/local/mycat/conf</code> æš´éœ²ç»™å®¿ä¸»æœºï¼Œå¯åŠ¨æ—¶ç›´æ¥æ˜ å°„ä¹‹å‰å®¿ä¸»æœºä¸Šå¤åˆ¶å¥½çš„ <code>conf</code> ç›®å½•ã€‚</li>
<li>è®¾ç½®ç¯å¢ƒå˜é‡ <code>MYCAT_HOME</code>ï¼Œå€¼æ˜¯ MyCat çš„å®‰è£…ç›®å½•ã€‚</li>
<li>æš´éœ² 8066 å’Œ 9066 ä¸¤ä¸ªç«¯å£ã€‚8066 ç«¯å£ç”¨äºå¤–éƒ¨è¿æ¥æ•°æ®åº“ï¼Œç±»ä¼¼äº MySQL çš„ 3306 ç«¯å£ï¼›9066 æ˜¯ MyCat çš„ç®¡ç†ç«¯å£ã€‚</li>
<li>æ‰§è¡Œå¯åŠ¨ MyCat çš„å‘½ä»¤ã€‚</li>
</ol>
<p>åœ¨å½“å‰ç›®å½•æ„å»ºé•œåƒï¼š</p>
<pre><code class="language-bash">$ docker build -t mycat-1.6.7.1 .
</code></pre>
<p>ç„¶åå¯åŠ¨ä¸€ä¸ªå®¹å™¨å®ä¾‹ï¼š</p>
<pre><code class="language-bash">$ docker run --name mycat -p 8066:8066 -p 9066:9066 -v /path/to/conf/:/usr/local/mycat/conf/ -d mycat-1.6.7.1 --link mysql-dn-s:mysql-slave --link mysql-dn-m:mysql-master 
</code></pre>
<p>æ³¨ï¼šä»¥ä¸Šå‘½ä»¤ä¸­çš„ <code>/path/to/conf/</code> æŒ‡çš„æ˜¯å®é™…å®¿ä¸»æœºä¸­ <code>conf</code>ç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚åŒæ—¶ï¼Œç”¨ <code>--link</code> åˆ›å»ºäº†ä¸ä¸¤ä¸ªæ•°æ®åº“ä¹‹é—´çš„ç½‘ç»œè¿æ¥ã€‚</p>
<p>ç°åœ¨ MyCat çš„å®¹å™¨å·²ç»è·‘èµ·æ¥äº†ï¼Œä½†æ˜¯åœ¨é…ç½®å¥½æ•°æ®æºä¹‹å‰è¿˜ä¸èƒ½ç”¨ã€‚</p>
<h2 id="2-ä¿®æ”¹-mycat-é…ç½®">2. ä¿®æ”¹ MyCat é…ç½®</h2>
<p>å› ä¸ºä¹‹å‰å¯åŠ¨å®¹å™¨çš„æ—¶å€™åšäº†é…ç½®æ–‡ä»¶ç›®å½•çš„æ˜ å°„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥åœ¨å®¿ä¸»æœºçš„ <code>conf</code> ç›®å½•ä¸­ä¿®æ”¹ MyCat çš„é…ç½®ã€‚</p>
<p>é¦–å…ˆä¿®æ”¹ <code>schema.xml</code>ï¼Œä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;
&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;

	&lt;!-- MyCat å¯¹å¤–æš´éœ²çš„ schema --&gt;
	&lt;schema name=&quot;test&quot; checkSQLschema=&quot;false&quot; sqlMaxLimit=&quot;100&quot; dataNode=&quot;dn1&quot;&gt;
	&lt;/schema&gt;
	
	&lt;!-- æ•°æ®èŠ‚ç‚¹ï¼Œè¿™é‡Œæˆ‘ä»¬åªé…ç½®è¯»å†™åˆ†ç¦»çš„éƒ¨åˆ†ï¼Œå› æ­¤åªé…ç½®ä¸€ä¸ªèŠ‚ç‚¹æ¥åšè¯»å†™åˆ†ç¦»çš„ç¤ºä¾‹ --&gt;
	&lt;dataNode name=&quot;dn1&quot; dataHost=&quot;localhost1&quot; database=&quot;test&quot; /&gt;
	
	&lt;!-- è¿™é‡Œçš„ balance=1 è¡¨ç¤ºé…ç½®è¯»å†™åˆ†ç¦»--&gt;
	&lt;dataHost name=&quot;localhost1&quot; maxCon=&quot;1000&quot; minCon=&quot;10&quot; balance=&quot;1&quot;
			  writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;native&quot; switchType=&quot;1&quot;  slaveThreshold=&quot;100&quot;&gt;
		&lt;!--å¿ƒè·³é€šçŸ¥çš„æŸ¥è¯¢è¯­å¥ï¼Œä½¿ç”¨é»˜è®¤å³å¯--&gt;
		&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;
		&lt;!--å†™åº“é…ç½®--&gt;
		&lt;writeHost host=&quot;hostM&quot; url=&quot;mysql-master:3306&quot; user=&quot;root&quot; password=&quot;admin123&quot;&gt;
			&lt;!--è¯»åº“é…ç½®--&gt;
			&lt;readHost host=&quot;hostS&quot; url=&quot;mysql-slave:3306&quot; user=&quot;root&quot; password=&quot;admin123&quot; /&gt;
		&lt;/writeHost&gt;
	&lt;/dataHost&gt;
	
&lt;/mycat:schema&gt;
</code></pre>
<p>å› ä¸ºæœ¬ç¤ºä¾‹åªæ¼”ç¤ºè¯»å†™åˆ†ç¦»ï¼Œä¸æ¶‰åŠåˆ†åŒºåˆ†ç‰‡ç­‰é…ç½®ï¼Œå› æ­¤è¿™ä¸ªé…ç½®æ–‡ä»¶å¾ˆç®€å•ã€‚</p>
<p>ä¸‹é¢é…ç½® <code>server.xml</code>ï¼Œåªéœ€æ‰“å¼€æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ª MyCat çš„å¤–éƒ¨è®¿é—®ç”¨æˆ·å³å¯ï¼Œä¹Ÿå¯é…ç½®å¤šä¸ªï¼Œè§†å…·ä½“æƒ…å†µè€Œå®šï¼š</p>
<pre><code class="language-xml">&lt;user name=&quot;root&quot; defaultAccount=&quot;true&quot;&gt;
		&lt;property name=&quot;password&quot;&gt;admin123&lt;/property&gt;
		&lt;property name=&quot;schemas&quot;&gt;test&lt;/property&gt;
&lt;/user&gt;
</code></pre>
<p>ä»¥ä¸Šä½œä¸ºæ¼”ç¤ºï¼Œåªé…ç½®äº†åŸºæœ¬çš„ç”¨æˆ·åã€å¯†ç å’Œåº“ï¼Œå®é™…æƒ…å†µä¸­ï¼Œè¿˜å¯ä»¥é…ç½®è¯»å†™æƒé™ï¼Œç”šè‡³æ˜¯è¡¨çº§ DML æƒé™ï¼Œå…·ä½“å¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚</p>
<p>é…ç½®å¥½åï¼Œé‡å¯å®¹å™¨ç”Ÿæ•ˆã€‚</p>
<h2 id="3-æµ‹è¯•éªŒè¯">3. æµ‹è¯•éªŒè¯</h2>
<p>ä½¿ç”¨ä¸è¿æ¥ MySQL åŒæ ·çš„æ–¹æ³•ï¼Œåœ¨å®¿ä¸»æœºä¸Šè¿æ¥ MyCatï¼š</p>
<pre><code class="language-bash">$ mycli -hlocalhost -P8066 -uroot -padmin123
</code></pre>
<p>æ³¨ï¼šå¦‚æœè¿æ¥ä¸æˆåŠŸï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹ä¸¤å° MySQL çš„ç”¨æˆ·è®¤è¯é…ç½®ï¼š<code>ALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'admin123';</code>ã€‚</p>
<p>è¿æ¥æˆåŠŸåï¼Œå°±å¯ä»¥åƒç›´æ¥æ“ä½œ MySQL ä¸€æ ·è¿›è¡Œæ•°æ®åº“æ“ä½œäº†ã€‚</p>
<h2 id="4-æµ‹è¯•è¯»å†™åˆ†ç¦»">4. æµ‹è¯•è¯»å†™åˆ†ç¦»</h2>
<p>åœ¨æµ‹è¯•è¯»å†™åˆ†ç¦»æ—¶ï¼Œéœ€è¦æŸ¥çœ‹ MyCat çš„æ—¥å¿—æ¥ç¡®å®šæ¯æ­¤æ“ä½œæ˜¯åœ¨å“ªä¸ªæ•°æ®åº“æ‰§è¡Œçš„ï¼Œå› æ­¤ï¼Œé¦–å…ˆéœ€è¦ä¿®æ”¹ä»¥ä¸‹ MyCat çš„æ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œæ¥è®© MyCat æŠŠè¿™éƒ¨åˆ†æ—¥å¿—æ‰“å°å‡ºæ¥ã€‚</p>
<p>åœ¨ <code>conf</code> ç›®å½•çš„ <code>log4j2.xml</code> æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code class="language-xml">&lt;asyncRoot level=&quot;info&quot; includeLocation=&quot;true&quot;&gt;
</code></pre>
<p>å°†å…¶ä¸­çš„æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º <code>debug</code>ï¼Œä¿®æ”¹ä¿å­˜åé‡å¯ MyCat å®¹å™¨ã€‚</p>
<p>ç°åœ¨ï¼Œè¿›å…¥ MyCat å®¹å™¨ä¸­ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œå®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼š</p>
<pre><code class="language-bash">$ tail -f /usr/local/mycat/logs/mycat.log
</code></pre>
<p>ä¸è¦å…³é—­æŸ¥çœ‹æ—¥å¿—çš„çª—å£ï¼Œå¦èµ·ä¸€ä¸ªç»ˆç«¯ï¼Œè¿æ¥ MyCat å¯¹æ•°æ®è¿›è¡Œæ“ä½œï¼Œåœ¨æ—¥å¿—ä¸­å°±å¯ä»¥çœ‹åˆ°æ¯ä¸€æ­¥æ“ä½œçš„ SQL è¯­å¥ï¼Œä»¥åŠå¯¹åº”çš„æ›´å¤šä¿¡æ¯ã€‚</p>
<p>æ¯”å¦‚ä¸‹é¢ä¸¤æ¡æ—¥å¿—ï¼š</p>
<pre><code class="language-bash">2019-09-07 08:46:42.628 DEBUG [$_NIOREACTOR-5-RW] (io.mycat.server.NonBlockingSession.releaseConnection(NonBlockingSession.java:386)) - release connection MySQLConnection [id=14, lastTime=1567846002623, user=root, schema=test, old shema=test, borrowed=true, fromSlaveDB=true, threadId=380, charset=utf8, txIsolation=3, autocommit=true, attachment=dn1{select * from test}, respHandler=SingleNodeHandler [node=dn1{select * from test}, packetId=9], host=mysql-slave, port=3306, statusSync=io.mycat.backend.mysql.nio.MySQLConnection$StatusSync@230d92a6, writeQueue=0, modifiedSQLExecuted=false]
</code></pre>
<pre><code class="language-bash">2019-09-07 08:48:23.387 DEBUG [$_NIOREACTOR-5-RW] (io.mycat.server.NonBlockingSession.releaseConnection(NonBlockingSession.java:386)) - release connection MySQLConnection [id=5, lastTime=1567846103379, user=root, schema=test, old shema=test, borrowed=true, fromSlaveDB=false, threadId=587, charset=utf8, txIsolation=3, autocommit=true, attachment=dn1{insert into test(value) values(15)}, respHandler=SingleNodeHandler [node=dn1{insert into test(value) values(15)}, packetId=1], host=mysql-master, port=3306, statusSync=null, writeQueue=0, modifiedSQLExecuted=true]
</code></pre>
<p>ä»è¿™ä¸¤æ¡æ—¥å¿—ä¸­å¯ä»¥çœ‹å‡º MyCat åœ¨è¯»åº“æ‰§è¡Œäº†æŸ¥è¯¢æ“ä½œï¼Œå¹¶åœ¨å†™åº“æ‰§è¡Œäº†æ’å…¥æ“ä½œã€‚</p>
<p>ğŸ‘</p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#0-%E5%89%8D%E6%8F%90">0. å‰æ</a></li>
<li><a href="#1-mycat-%E5%AE%B9%E5%99%A8%E9%83%A8%E7%BD%B2">1. MyCat å®¹å™¨éƒ¨ç½²</a></li>
<li><a href="#2-%E4%BF%AE%E6%94%B9-mycat-%E9%85%8D%E7%BD%AE">2. ä¿®æ”¹ MyCat é…ç½®</a></li>
<li><a href="#3-%E6%B5%8B%E8%AF%95%E9%AA%8C%E8%AF%81">3. æµ‹è¯•éªŒè¯</a></li>
<li><a href="#4-%E6%B5%8B%E8%AF%95%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB">4. æµ‹è¯•è¯»å†™åˆ†ç¦»</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://blog.fanbin.dev/post/Qg_Mg199T">
              <h3 class="post-title">
                MySQL ä¸»ä»å¤åˆ¶
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  <img src='http://blog-fanbin-ink.img.fanbin.ink/avatar.jpg' style='width:40px;border-radius:20px' />
<p style='margin:10px;'>Writen by Fan Bin</p>
<p style='margin:10px;'><span style="background-color:#5aceb2;">&nbsp;</span><span style="background-color:#ff7250;">&nbsp;</span><span style="background-color:#fbbe3e;">&nbsp;</span><span style="background-color:#5bb9cd;">&nbsp;</span></p>
Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://blog.fanbin.dev/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()

  let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

  // This should probably be throttled.
  // Especially because it triggers during smooth scrolling.
  // https://lodash.com/docs/4.17.10#throttle
  // You could do like...
  // window.addEventListener("scroll", () => {
  //    _.throttle(doThatStuff, 100);
  // });
  // Only not doing it here to keep this Pen dependency-free.

  window.addEventListener("scroll", event => {
    let fromTop = window.scrollY;

    mainNavLinks.forEach((link, index) => {
      let section = document.getElementById(decodeURI(link.hash).substring(1));
      let nextSection = null
      if (mainNavLinks[index + 1]) {
        nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
      }
      if (section.offsetTop <= fromTop) {
        if (nextSection) {
          if (nextSection.offsetTop > fromTop) {
            link.classList.add("current");
          } else {
            link.classList.remove("current");    
          }
        } else {
          link.classList.add("current");
        }
      } else {
        link.classList.remove("current");
      }
    });
  });

</script>

      </div>
    </div>
  </body>
</html>
